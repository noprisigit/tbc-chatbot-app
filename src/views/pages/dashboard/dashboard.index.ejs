<div class="row">
  <div class="col-12 col-md-6 col-lg-8">
    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="row">
          <div class="col-12 col-md-3 d-flex align-items-center justify-content-center">
            <img src="/img/logo-sibimo.png" alt="Logo SiBIMO" width="200">
          </div>
          <div class="col-12 col-md-9">
            <h3 class="text-primary">Selamat Datang di Aplikasi Si BIMO</h3>
            <p>
              <strong>SI-BIMO</strong> adalah layanan pendampingan digital bagi pasien <strong>Tuberkulosis
                (TB)</strong> yang bertujuan: <br />
              ðŸ’Š Mengingatkan jadwal minum obat anti-TB secara tepat waktu <br />
              ðŸ“… Memberi notifikasi jadwal pengambilan obat <br />
              ðŸ’¬ Menyediakan fitur Q&A otomatis berbasis ChatGPT untuk meningkatkan pemahaman pasien tentang TB

              <br />
              <br />
              Bersama <strong>SI-BIMO</strong>, pengobatan TB jadi lebih terpantau dan edukatif!
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-12 col-md-6 col-lg-4">
    <div class="card shadow mb-3">
      <div class="card-body">
        <h3 class="text-primary text-center">
          QR Code Whatsapp
        </h3>

        <div id="qr-container" class="text-center mt-3">
          <div id="qr-img-wrapper">
            <img id="qr-img" class="text-center d-flex mx-auto" style="max-width: 300px; display:none;">
          </div>

          <div id="loading-wrapper">
            <span id="spinner" class="spinner spinner-border text-primary text-center"></span>
            <p id="status" class="mt-3 text-muted">Loading...</p>
          </div>

          <div class="d-none alert alert-important alert-success d-flex align-items-center justify-content-center"
            role="alert">
            <p class="mb-0 text-center">âœ… WhatsApp sudah terhubung</p>
          </div>
          <button id="logout-btn" class="btn btn-danger mt-3 mx-auto" style="display: none;">Logout</button>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="row">
  <div class="col-md-3">
    <div class="card text-white bg-success mb-3">
      <div class="card-header fw-bold">Customer Aktif</div>
      <div class="card-body">
        <h5 class="card-title">
          <%= totalCustomers %> orang
        </h5>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-white bg-info mb-3">
      <div class="card-header fw-bold">Schedule Aktif</div>
      <div class="card-body">
        <h5 class="card-title">
          <%= totalActiveSchedules %> jadwal
        </h5>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-white bg-warning mb-3">
      <div class="card-header fw-bold">Schedule Tidak Aktif</div>
      <div class="card-body">
        <h5 class="card-title">
          <%= totalInactiveSchedules %> jadwal
        </h5>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-white bg-primary mb-3">
      <div class="card-header fw-bold">Log Hari Ini</div>
      <div class="card-body">
        <h5 class="card-title">
          <%= logsToday %> notifikasi
        </h5>
      </div>
    </div>
  </div>
</div>

<div class="card shadow">
  <div class="card-header">
    <h3 class="card-title">
      Log Terbaru
    </h3>
  </div>
  <div class="card-body">
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>Pesan</th>
            <th>Context</th>
            <th>Status</th>
            <th>Waktu</th>
          </tr>
        </thead>
        <tbody>
          <% latestLogs.forEach((log, index)=> { %>
            <tr>
              <td>
                <%= index + 1 %>
              </td>
              <td>
                <%= log.message %>
              </td>
              <td>
                <%= log.context %>
              </td>
              <td>
                <% if (log.level==='info' ) { %>
                  <span class="badge bg-success me-1"></span>
                  <% } else if (log.level==='warn' ) { %>
                    <span class="badge bg-warning me-1"></span>
                    <% } else { %>
                      <span class="badge bg-danger me-1"></span>
                      <% } %>

                        <%= log.level %>
              </td>
              <td>
                <%= new Date(log.timestamp).toLocaleString("id-ID") %>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<% script=`<script src="/js/pages/whatsapp.js">
  </script>`; %>